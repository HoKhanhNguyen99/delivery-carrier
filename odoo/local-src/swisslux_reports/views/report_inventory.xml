<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <template id="report_delivery_document_in_out" priority="100" inherit_id="stock.report_delivery_document">
            <!-- Stylesheet -->
            <xpath expr="//div[@class='row']" position="before">
                <style type="text/css">
                    .upright{
                        text-align: right !important;
                    }
                    .bold{
                        font-weight: bold;
                    }
                    .line{
                        margin: 0px 30px 0px 30px;
                        border-style: solid;
                        border-width: 1px;
                    }
                    h2{
                      font-weight: bold;
                      font-size: 18px;
                      margin-bottom: 0px;
                      margin-top: 80px;
                    }
                    #informations{
                      padding-bottom: 12px;
                      margin-bottom: 12px;
                    }
                    .page{
                      margin-right: 25px !important;
                      margin-left: 60px !important;
                    }
                    #addressout{
                      margin-top: 35px;
                    }
                    #padding{
                      margin-bottom: 5px;
                    }
                    .address{
                      # position: fixed;
                      left: 215px;
                    }
                    .pl-0{
                      padding-left: 0px;
                    }
                    .ml-0{
                      margin-left: 0px;
                    }
                </style>
            </xpath>
            <!-- Throwing away unuseful table & Title -->
            <xpath expr="//h2" position="replace"> </xpath>
            <xpath expr="//table[@class='table table-condensed']" position="replace"> </xpath>

            <xpath expr="//table[@class='table table-condensed mt48']" position="replace"> </xpath>

            <!-- Address on top of document -->
            <xpath expr="//div[@class='page']/div[@class='row'] " position="replace">
                <t t-if="o.picking_type_id.code == 'incoming'">
                    <div class="col-xs-6 bold">
                        <span t-field="o.company_id.name"/>, <span t-field="o.company_id.zip"/> <span t-field="o.company_id.city"/>
                    </div>
                    <div class="col-xs-3">
                        Datum : <br/>
                        Mitarbeiter :<br/>
                        RG/LS-Nr :<br/>
                        Lieferant :<br/>
                        Lieferant :<br/>
                    </div>
                    <div class="col-xs-3">
                        <span t-esc='time.strftime("%d.%m.%Y")'/><br/>
                        ______________<br/>
                        ______________<br/>
                        <span t-esc="o.partner_id.name"/><br/>
                        <span t-esc="o.group_id.name"/><br/>
                        <br/>
                    </div>
                    <h2 class="mb16">
                        <span t-field="o.name"/>
                    </h2>
                </t><!-- IF incoming-->
                <t t-if="o.picking_type_id.code == 'outgoing'">
                    <small>
                        <div class="row">
                            <div class="col-xs-12" style="text-align: right;">
                              <small>
                                <small>
                                  <strong>
                                    Your client manager
                                  </strong>
                                  <t t-if="o.sale_id">
                                    <span t-field="o.sale_id.user_id"/><br/>
                                  </t>
                                  <t t-if="not o.sale_id">
                                    <span t-field="o.partner_id.user_id"/><br/>
                                  </t>
                                  Tel:
                                  <t t-if="o.get_employee_from_user()">
                                    <span t-field="o.get_employee_from_user().work_phone"/><br/>
                                  </t>
                                  <t t-if="o.sale_id">
                                    <t t-if="not o.get_employee_from_user().work_phone">
                                      &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;
                                      &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;<br/>
                                    </t>
                                  </t>
                                  <t t-if="o.sale_id">
                                      <span t-field="o.get_employee_from_user(o.sale_id.user_id).work_email"/>
                                  </t>
                                  <t t-if="not o.sale_id">
                                      <span t-field="o.get_employee_from_user(o.partner_id.user_id).work_email"/>
                                  </t>
                                </small>
                              </small>
                            </div>
                          </div>
                    </small>
                    <div class="row col-xs-6" id="addressout">
                        <div t-if="o.partner_id" name="partner_header">
                          <t t-if="o.partner_id.parent_id">
                            <span t-field="o.partner_id.parent_id.name"/>
                             <br/>
                          </t>
                            <span t-field="o.partner_id.name"/>
                            <div t-field="o.partner_id"
                               t-field-options='{"widget": "contact", "fields": ["address"], "no_marker": true}'/>
                        </div>
                    </div>
                    <div class="row col-xs-12">
                          <span> </span> <!-- Black line to ensure layout downside -->
                    </div>
                    <div class="row mt32 mb32" id="informations">
                        <div class="col-xs-12" name="reference" id="padding">
                            <div class="row">
                            <div class="col-xs-12">
                            <h2 t-if="o.name">Delivery Slip <span t-field="o.name"/></h2>
                            <br/>
                            </div>
                            </div>
                            <div class="row">
                            <span class="col-xs-2"><strong>Your reference:</strong></span>
                            <t t-if="o.sale_id.client_order_ref">
                              <strong class="col-xs-10 pl-0" t-field="o.sale_id.client_order_ref"/>
                            </t>
                            </div>
                        </div>
                        <div class="col-xs-7"></div>
                        <div class="col-xs-12">
                        <div class="row">
                        <div class="col-xs-6 pl-0" style="margin-left: 0px; padding-left: 0px;width=20px;">
                          <div t-if="o.sale_id.partner_id.parent_id" class="col-xs-12">
                            <span class="col-xs-4 pl-0">Contact:</span>
                                <span class="col-xs-8 pl-0"><span t-field="o.sale_id.partner_id.parent_id.name"/>, <span t-field="o.sale_id.partner_id.name"/></span>
                          </div>
                          <div t-if="not o.sale_id.partner_id.parent_id" class="col-xs-12">
                            <span class="col-xs-4 pl-0">Contact:</span>
                                <span class="col-xs-8 pl-0"><span t-field="o.sale_id.partner_id.name"/></span>
                          </div>

                          <div t-if="o.sale_id.client_order_contact_type" class="col-xs-12">
                              <span class="col-xs-4 pl-0">Your order:</span>
                              <span class="address"><span t-field="o.sale_id.client_order_contact_type"/><t t-if="o.sale_id.client_order_date">, <span t-field="o.sale_id.client_order_date"/></t>
                              </span>
                          </div>
                          <div class="col-xs-12">
                              <span class="col-xs-4 pl-0">Client number:</span>
                              <span t-if="o.partner_id.is_company">
                                <span class="address" t-field="o.partner_id.ref"/>
                              </span>
                              <span t-if="not o.partner_id.is_company">
                                <span class="address" t-field="o.partner_id.parent_id.ref"/>
                              </span>
                          </div>
                          <div t-if="not o.partner_id.country_id.code == 'CH'" class="col-xs-12" >
                              <span class="col-xs-4 pl-0">EORI NR:</span>
                              <span class="address" t-field="o.partner_id.eori_number"/>
                          </div>
                        </div>
                        <div class="col-xs-6">
                          <div t-if="o.scheduled_date" class="col-xs-12">
                              <span t-if="1" class="col-xs-4 pl-0">Date:</span>
                              <span t-field="o.scheduled_date" t-field-options='{"widget":"date"}'/>
                          </div>
                          <div t-if="o.carrier_id" class="col-xs-12">
                              <span class="col-xs-4 pl-0">Carrier:</span>
                              <span t-field="o.carrier_id"/>
                          </div>
                          <div t-if="not o.carrier_id" class="col-xs-12">
                              <span class="col-xs-4 pl-0">Carrier:</span>
                              <span>no carrier</span>
                          </div>
                          <div class="col-xs-12">
                              <span class="col-xs-4 pl-0">Sale Order:</span>
                              <span t-field="o.sale_id.name" />
                          </div>
                        </div>
                        </div>
                        </div>
                    </div><!-- Box info-->
                </t><!-- IF outgoing-->
            </xpath>

            <!-- Table part -->
            <xpath expr="//table[@class='table table-condensed mt48']" position="replace">
                <t t-if="o.picking_type_id.code == 'incoming'">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Art-Nr.<br/>
                                    E-No.<br/>
                                    Art.Date</th>
                                <th>Bezeichnung Liferantenbezeichnung Inhalt</th>
                                <th>Bestellmenge<br/>
                                    Liefermenge<br/>
                                    Rückstand
                                </th>
                                <th>Bemerkungen<br/>
                                    Zu veranlassen
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-if="o.move_line_ids">
                                <tr t-foreach="o.move_line_ids" t-as="move_line">
                                    <td><span t-field="move_line.product_id.default_code"/><br/>
                                    <t t-if="not move_line.product_id and move_line.package_id">
                                        <span  t-field="move_line.package_id"/><br/>
                                    </t>
                                    <span t-field="move_line.product_id.e_nr"/>
                                    </td>
                                    <td>
                                        <span t-field="move_line.product_id.name"/>
                                        <t t-if="move_line.product_id.description_sale">
                                          <span t-field="move_line.product_id.description_sale"/>
                                        </t>
                                        <br/>
                                        Logistik:<br/>
                                        <t t-if="move_line.product_id.product_tmpl_id.manual_code">
                                        _____ Manual-Code: <span t-field="move_line.product_id.product_tmpl_id.manual_code"/><br/>
                                        </t>
                                        <span t-field="o.company_id.receipt_checklist"/><br/>
                                    </td>
                                    <td>
                                        <span t-field="move_line.product_qty"/> <span t-field="move_line.product_uom_id"/><br/>
                                    <br/>
                                    ________<br/>
                                    ________<br/>
                                    </td>
                                    <td>
                                        <span t-field="move_line.product_id.receipt_checklist"/>
                                    </td>
                                </tr>
                            </t>
                            <t t-if="not o.move_line_ids">
                                <tr t-foreach="o.move_lines" t-as="move">
                                    <td><span t-field="move.product_id.default_code"/><br/>
                                    <t t-if="not move.product_id and move.package_id">
                                        <span  t-field="move.package_id"/><br/>
                                    </t>
                                    <span t-field="move.product_id.e_nr"/>
                                    </td>
                                    <td>
                                        <span t-field="move.product_id.name"/><br/>
                                        <t t-if="move.product_id.description_sale">
                                          <span t-field="move.product_id.description_sale"/>
                                        </t>
                                        <br/>
                                        Logistik:<br/>
                                        <t t-if="move.product_id.product_tmpl_id.manual_code">
                                        _____ Manual-Code: <span t-field="move.product_id.product_tmpl_id.manual_code"/><br/>
                                        </t>
                                        <span t-field="o.company_id.receipt_checklist"/><br/>
                                    </td>
                                    <td>
                                        <span t-field="move.product_qty"/> <span t-field="move.product_uom"/><br/>
                                    <br/>
                                    ________<br/>
                                    ________<br/>
                                    </td>
                                    <td>
                                        <span t-field="move.product_id.receipt_checklist"/>
                                    </td>
                                </tr>
                            </t> <!-- IF no move_line_ids-->
                        </tbody>
                    </table>
                </t> <!-- IF incoming-->
                <t t-if="o.picking_type_id.code == 'outgoing'">
                    <table class="table table-condensed mt48">
                        <thead>
                        <tr>
                          <th>Pos.</th>
                          <th>Menge</th>
                          <th>E-No.<br/>Artikel-Nr.</th>
                          <th>Bezeichnung</th>
                        </tr>
                        </thead>
                        <t t-set="line_counter" t-value="0"/>
                        <tr t-foreach="o.move_lines" t-as="m">
                            <td>
                                <t t-set="line_counter" t-value="line_counter + 1"/>
                                <span t-raw="line_counter"/>
                            </td>

                            <td>
                                <t t-if="m.product_uom_qty == o.env.ref('product.product_uom_unit')">
                                  <span t-raw="int(m.product_uom_qty or 0)"/>
                                </t>
                                <t t-if="m.product_uom_qty != o.env.ref('product.product_uom_unit')">
                                  <span t-raw="round(m.product_uom_qty, 2)"/>
                                </t>
                                <span t-field="m.product_uom"/>
                            </td>
                            <td>
                                <t t-if="m.product_id.e_nr">
                                    <span t-field="m.product_id.cut_e_nr"/>
                                </t>
                                <t t-if="not m.product_id.e_nr">
                                    -
                                </t>
                                <br/>
                                <t t-if="m.product_id.default_code">
                                  <span t-field="m.product_id.default_code"/>
                                </t>
                                <t t-if="not m.product_id.default_code">
                                  -
                                </t>
                            </td>
                            <td>
                                <span  t-raw="m.name.replace('\n','&lt;br/&gt;')"/>
                            </td>
                        </tr>

                    </table>
                </t><!-- IF outgoing -->
            </xpath>

    </template>

</odoo>
