<?xml version="1.0" encoding="UTF-8"?>
<odoo>

  <template id="fix_address_report_followup_letter_body" inherit_id="account_reports.followup_filter_info_template">
    <xpath expr="//div[@class='row']" position="before">
      <style type="text/css">
        .head{
        margin-left: 0px !important;
        }
        .address{
        padding-top: 110px;
        }
        body > div{
        margin-left: 68px !important;
        }
        .o_account_reports_summary{
        width:80%;
        }
        .o_account_reports_table {
        # border: 1px solid black; # useful for style debug
        background-color: rgba(0, 0, 0, 0) ;
        border-collapse: collapse ;
        color: rgb(0, 0, 0) ;
        font-family: Helvetica, Arial ;
        font-size: 14px ;
        margin-bottom: 20px ;
        text-size-adjust: 100% ;
        word-wrap: break-word ;
        }
        .o_account_reports_table td{
        padding-left: 5px;
        text-align: left;
        word-wrap: break-word ;
        }

        .o_account_reports_table tr:nth-child(n+1):nth-last-child(n+3) {
        border-top: 1px solid #DBDBDB;

        }

        .o_account_reports_table tr:nth-last-child(2) td:nth-last-child(-n+2) {
        border-top: 1px solid black;
        border-bottom: 1px solid black;

        }

        .o_account_reports_table th{
        border-bottom: 1px solid black;
        padding-left: 5px;
        text-align: left;

        }
        .o_account_reports_table th:last-child{
        text-align:right;
        padding-right: 5px;
        }

        .o_account_reports_table td:last-child{
        text-align:right;
        padding-right: 5px;
        }


        .o_account_reports_table tr:nth-last-child(-n+2){
        font-weight: bold;
        }

        .unreconciled_aml.o_account_reports_domain_line_2 {
        margin-left: 5px !important;
        }
        .unreconciled_aml.o_account_reports_domain_line_2:before {
        content: "\00a0";
        }


      </style>
    </xpath>

    <xpath expr="//p[@style]" position="replace">
    </xpath>


    <xpath expr="//div[@class='row']" position="replace">
      <div class="row head">
        <div class="address">
          <div style="text-decoration: underline; padding-left: 0px;">
            <span t-field="partner.company_id.name"/>, <span t-field="partner.company_id.street"/>, <span t-field="partner.company_id.zip"/> <span t-field="partner.company_id.city"/>

            <br/>
            <br/>
          </div>
          <div t-field="partner.name"/>
          <div t-field="partner.self"
               t-field-options='{"widget": "contact", "fields": ["address"], "no_marker": true}'/>
          <span t-field="partner.vat"/>
          <br/>
        </div>
      </div>
      <div class="row head">
        <p style='margin-top: 35px;'>
          Document: Customer account statement<br/>
          Date: <span t-esc="today"/><br/>
          Client number: <span t-field="partner.ref"/>
        </p>
        <br/>
        <br/>
        <br/>
      </div>
    </xpath>

  </template>


  <template id="main_template_inherit" inherit_id="account_reports.main_template">

    <!-- To have the full table into the page -->
    <xpath expr="//table" position="attributes">
      <attribute name="width">90%</attribute>
    </xpath>

    <!-- Add space after summary -->
    <xpath expr="//table" position="before">
      <br/>
      <br/>
    </xpath>

  </template>

  <template id="account_reports.report_followup_body" inherit_id="account_reports.template_followup_report" primary="True">
    <xpath expr="//h2" position="after">
      <div t-if="mode != 'print' and not context.env.context.get('public')">
        <div class='pull-right' id='history'>
          <div t-if='context.get_history()' class="btn-group dropdown">
            <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
              History <span class="caret"></span>
            </button>
            <ul class="dropdown-menu dropdown-menu-right o_account_reports_history" role="menu">
              <t t-foreach="context.get_history()" t-as='msg'>
                <li role="presentation" style='margin-left: 5px'><t t-esc='msg.date' /> (<t t-esc='msg.author_id.name' />) : <t t-raw='msg.body' /></li>
                <li role="presentation" class="divider"></li>
              </t>
            </ul>
          </div>
        </div>
        <p class='o_account_reports_contact_info'>
          <t t-if='context.invoice_address_id.phone'><i class='fa fa-phone fa-fw' /><t t-esc="context.invoice_address_id.phone" /><br /></t>
          <t t-if='context.invoice_address_id.mobile'><i class='fa fa-mobile fa-fw' /><t t-esc="context.invoice_address_id.mobile" /><br /></t>
          <t t-if='context.invoice_address_id.fax'><i class='fa fa-fax fa-fw' /><t t-esc="context.invoice_address_id.fax" /><br /></t>
          <t t-if='context.invoice_address_id.email'>
            <a t-att-href="'mailto:' + context.invoice_address_id.email">
              <i class='fa fa-envelope' /><t t-esc="' ' + context.invoice_address_id.email" />
            </a>
          </t>
        </p>
      </div>
    </xpath>

    <xpath expr="//thead" position="replace">

      <thead>
        <tr>
          <th>Invoice Number</th>
          <t t-set="column" t-value="0" />
          <t t-set="cols_w"/>
          <t t-foreach="context.get_columns_names()" t-as="column_name">
            <t t-set="column" t-value="column + 1" />
            <th class="text-left" t-raw="column_name"/>
          </t>
        </tr>
      </thead>
    </xpath>
    <xpath expr="//h2" position="replace">
      <h2 t-if="not context.env.context.get('public')">
        <span><a t-att-data-active-id="context.partner_id.id" data-res-model="res.partner" class="o_account_reports_web_action"><t t-esc='context.partner_id.name' /></a></span>
        <span t-if="context.partner_id.country_id"><small>(<t t-esc='context.partner_id.country_id.name' />)</small></span>
      </h2>
    </xpath>
    <xpath expr="//h4" position="replace" />
    <xpath expr="//div[@class='o_account_reports_summary']" position="before">
      <div t-if="mode != 'print' and not context.env.context.get('public')">
        <span id='action-buttons' class='o_account_reports_followup_not_clicked'>
          <button class="btn btn-primary followup-letter" action="print_followup" t-att-data-partner="partner.id">Print Letter</button>
          <button class="btn btn-primary followup-email" t-att-data-partner="partner.id">Send by email</button>
          <button class="btn btn-default o_account_reports_followup-set-next-action" t-att-data-partner="partner.id">Log a Note</button>
          <button class="btn btn-primary o_account_reports_followup_done" t-att-data-partner="partner.id">Done</button>
          <button class="btn btn-default o_account_reports_followup_skip" t-att-data-partner="partner.id">Do it Later</button>
        </span>
        <div class='pull-right' id='followup-mode'>
          Next Reminder:
          <div class='btn-group'>
            <button t-att-class="'btn o_account_reports_followup-auto ' + (context.partner_id.payment_next_action_date &lt;= today and 'btn-info' or 'btn-default')">Auto</button>
            <button t-att-class="'btn o_account_reports_followup-manual o_account_reports_followup-set-next-action ' + (context.partner_id.payment_next_action_date &lt;= today and 'btn-default' or 'btn-info')" t-att-data-partner="str(context.partner_id.id)">Manual</button>
          </div>
        </div>
      </div>
    </xpath>
  </template>


</odoo>
